<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NOC Calendar - Admin</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .calendar-cell { min-height: 96px; }
        .calendar-cell:hover { background-color: #dbeafe; }
        .selected-cell { ring: 2px solid #3b82f6; }
        .modal { display: none; position: fixed; z-index: 50; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.5); }
        .modal.show { display: flex; align-items: center; justify-content: center; }
        .page { display: none; }
        .page.active { display: block; }
        .loading { position: fixed; top: 0; left: 0; right: 0; background: #3b82f6; color: white; padding: 8px; text-align: center; z-index: 100; }
    </style>
</head>
<body class="bg-gray-50">
    <div id="loadingBar" class="loading" style="display:none;">Saving changes...</div>
    
    <div class="bg-red-600 text-white shadow-lg">
        <div class="max-w-6xl mx-auto px-6 py-4">
            <div class="flex justify-between items-center">
                <div>
                    <h1 class="text-xl font-bold">üîê NOC Calendar - Admin Panel</h1>
                    <p class="text-sm text-red-100 mt-1">Edit mode ‚Ä¢ Changes save to GitHub</p>
                </div>
                <div class="flex gap-4">
                    <button onclick="showPage('calendar')" id="navCalendar" class="px-4 py-2 rounded-lg font-semibold bg-red-700">üìÖ Calendar</button>
                    <button onclick="showPage('engineers')" id="navEngineers" class="px-4 py-2 rounded-lg font-semibold hover:bg-red-700">üë• Engineers</button>
                    <button onclick="showPage('settings')" id="navSettings" class="px-4 py-2 rounded-lg font-semibold hover:bg-red-700">‚öôÔ∏è Settings</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Settings Page -->
    <div id="settingsPage" class="page active">
        <div class="max-w-4xl mx-auto p-6">
            <div class="bg-white rounded-lg shadow-lg p-6">
                <h2 class="text-2xl font-bold text-gray-800 mb-6">GitHub Settings</h2>
                <div class="bg-red-50 border-l-4 border-red-400 p-4 mb-6">
                    <p class="text-sm text-red-800"><strong>‚ö†Ô∏è Admin Only:</strong> Enter your GitHub token to enable editing.</p>
                </div>
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">GitHub Username:</label>
                        <input type="text" id="githubUsername" value="dher405" class="w-full p-3 border border-gray-300 rounded-lg">
                    </div>
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">Repository Name:</label>
                        <input type="text" id="githubRepo" value="Work" class="w-full p-3 border border-gray-300 rounded-lg">
                    </div>
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">Personal Access Token:</label>
                        <input type="password" id="githubToken" placeholder="ghp_xxxxxxxxxxxx" class="w-full p-3 border border-gray-300 rounded-lg">
                    </div>
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">Branch:</label>
                        <input type="text" id="githubBranch" value="main" class="w-full p-3 border border-gray-300 rounded-lg">
                    </div>
                    <button onclick="saveSettings()" class="w-full bg-green-500 text-white px-4 py-3 rounded-lg hover:bg-green-600 font-semibold">Save & Load Data</button>
                </div>
                <div id="settingsStatus" class="mt-4"></div>
            </div>
        </div>
    </div>

    <!-- Calendar Page -->
    <div id="calendarPage" class="page">
        <div class="max-w-6xl mx-auto p-6">
            <div class="bg-white rounded-lg shadow-lg p-6">
                <div class="flex items-center justify-between mb-6 flex-wrap gap-4">
                    <h2 class="text-2xl font-bold text-gray-800">NOC Rotation</h2>
                    <div class="flex items-center gap-4">
                        <button onclick="changeMonth(-1)" id="prevBtn" class="p-2 rounded-lg bg-blue-500 text-white hover:bg-blue-600"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path></svg></button>
                        <span id="monthDisplay" class="text-xl font-semibold min-w-48 text-center"></span>
                        <button onclick="changeMonth(1)" id="nextBtn" class="p-2 rounded-lg bg-blue-500 text-white hover:bg-blue-600"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg></button>
                    </div>
                </div>
                <div class="mb-4 flex gap-4 text-xs flex-wrap items-center">
                    <div class="flex items-center gap-2"><div class="w-4 h-4 bg-indigo-100 border border-indigo-300 rounded"></div><span>üåô Night</span></div>
                    <div class="flex items-center gap-2"><div class="w-4 h-4 bg-amber-100 border border-amber-300 rounded"></div><span>üåÖ Early</span></div>
                    <div class="flex items-center gap-2"><div class="w-4 h-4 bg-green-100 border border-green-300 rounded"></div><span>‚òÄÔ∏è Day</span></div>
                    <div class="flex items-center gap-2"><div class="w-4 h-4 bg-purple-100 border border-purple-300 rounded"></div><span>üåÜ Evening</span></div>
                    <div class="ml-auto flex gap-2">
                        <button onclick="showRedistributeModal()" class="px-3 py-1 text-xs bg-green-500 text-white rounded hover:bg-green-600">üîÑ Redistribute</button>
                        <button onclick="resetRotation()" class="px-3 py-1 text-xs bg-red-500 text-white rounded hover:bg-red-600">Reset</button>
                    </div>
                </div>
                <div class="grid grid-cols-7 gap-0 border border-gray-300 rounded-lg overflow-hidden">
                    <div class="bg-gray-100 p-2 text-center font-semibold text-sm border-b">Sunday</div>
                    <div class="bg-gray-100 p-2 text-center font-semibold text-sm border-b">Monday</div>
                    <div class="bg-gray-100 p-2 text-center font-semibold text-sm border-b">Tuesday</div>
                    <div class="bg-gray-100 p-2 text-center font-semibold text-sm border-b">Wednesday</div>
                    <div class="bg-gray-100 p-2 text-center font-semibold text-sm border-b">Thursday</div>
                    <div class="bg-gray-100 p-2 text-center font-semibold text-sm border-b">Friday</div>
                    <div class="bg-gray-100 p-2 text-center font-semibold text-sm border-b">Saturday</div>
                    <div id="calendarGrid"></div>
                </div>
                <div id="selectedDetails" class="mt-6 hidden"></div>
            </div>
        </div>
    </div>

    <!-- Engineers Page -->
    <div id="engineersPage" class="page">
        <div class="max-w-6xl mx-auto p-6">
            <div class="bg-white rounded-lg shadow-lg p-6">
                <div class="flex items-center justify-between mb-6">
                    <h2 class="text-2xl font-bold">Manage Engineers</h2>
                    <button onclick="addEngineer()" class="px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600">+ Add</button>
                </div>
                <div class="overflow-x-auto">
                    <table class="w-full border-collapse border">
                        <thead><tr class="bg-gray-100">
                            <th class="border p-2 text-left text-sm">Name</th>
                            <th class="border p-2 text-left text-sm">Email</th>
                            <th class="border p-2 text-left text-sm">Shift</th>
                            <th class="border p-2 text-center text-sm">Sun</th>
                            <th class="border p-2 text-center text-sm">Mon</th>
                            <th class="border p-2 text-center text-sm">Tue</th>
                            <th class="border p-2 text-center text-sm">Wed</th>
                            <th class="border p-2 text-center text-sm">Thu</th>
                            <th class="border p-2 text-center text-sm">Fri</th>
                            <th class="border p-2 text-center text-sm">Sat</th>
                            <th class="border p-2 text-center text-sm">Actions</th>
                        </tr></thead>
                        <tbody id="engineersTable"></tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Modals -->
    <div id="editModal" class="modal">
        <div class="bg-white rounded-lg shadow-xl p-6 max-w-md w-full mx-4">
            <h3 class="text-xl font-bold mb-4">Edit Shift</h3>
            <div class="mb-4"><label class="block text-sm font-semibold mb-2">Date:</label><div id="modalDate" class="text-sm"></div></div>
            <div class="mb-4"><label class="block text-sm font-semibold mb-2">Shift:</label><div id="modalShift" class="text-sm"></div></div>
            <div class="mb-6"><label class="block text-sm font-semibold mb-2">Assign To:</label><select id="engineerSelect" class="w-full p-2 border rounded-lg"></select></div>
            <div class="flex gap-3">
                <button onclick="saveEdit()" class="flex-1 bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600">Save</button>
                <button onclick="closeModal()" class="flex-1 bg-gray-300 px-4 py-2 rounded-lg hover:bg-gray-400">Cancel</button>
            </div>
        </div>
    </div>

    <div id="editEngineerModal" class="modal">
        <div class="bg-white rounded-lg shadow-xl p-6 max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto">
            <h3 class="text-xl font-bold mb-4">Edit Engineer</h3>
            <div class="space-y-4">
                <div><label class="block text-sm font-semibold mb-2">Name:</label><input type="text" id="editEngName" class="w-full p-2 border rounded-lg"></div>
                <div><label class="block text-sm font-semibold mb-2">Email:</label><input type="email" id="editEngEmail" class="w-full p-2 border rounded-lg"></div>
                <div><label class="block text-sm font-semibold mb-2">Shift:</label><select id="editEngShift" class="w-full p-2 border rounded-lg"><option value="night">Night</option><option value="early">Early</option><option value="day">Day</option><option value="evening">Evening</option></select></div>
                <div class="grid grid-cols-2 md:grid-cols-4 gap-3">
                    <div><label class="block text-sm font-semibold mb-1">Sun:</label><input type="text" id="editEngSun" placeholder="OFF or HH:MM-HH:MM" class="w-full p-2 border rounded-lg text-sm"></div>
                    <div><label class="block text-sm font-semibold mb-1">Mon:</label><input type="text" id="editEngMon" placeholder="OFF or HH:MM-HH:MM" class="w-full p-2 border rounded-lg text-sm"></div>
                    <div><label class="block text-sm font-semibold mb-1">Tue:</label><input type="text" id="editEngTue" placeholder="OFF or HH:MM-HH:MM" class="w-full p-2 border rounded-lg text-sm"></div>
                    <div><label class="block text-sm font-semibold mb-1">Wed:</label><input type="text" id="editEngWed" placeholder="OFF or HH:MM-HH:MM" class="w-full p-2 border rounded-lg text-sm"></div>
                    <div><label class="block text-sm font-semibold mb-1">Thu:</label><input type="text" id="editEngThu" placeholder="OFF or HH:MM-HH:MM" class="w-full p-2 border rounded-lg text-sm"></div>
                    <div><label class="block text-sm font-semibold mb-1">Fri:</label><input type="text" id="editEngFri" placeholder="OFF or HH:MM-HH:MM" class="w-full p-2 border rounded-lg text-sm"></div>
                    <div><label class="block text-sm font-semibold mb-1">Sat:</label><input type="text" id="editEngSat" placeholder="OFF or HH:MM-HH:MM" class="w-full p-2 border rounded-lg text-sm"></div>
                </div>
            </div>
            <div class="flex gap-3 mt-6">
                <button onclick="saveEngineer()" class="flex-1 bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600">Save</button>
                <button onclick="closeEngineerModal()" class="flex-1 bg-gray-300 px-4 py-2 rounded-lg hover:bg-gray-400">Cancel</button>
            </div>
        </div>
    </div>

    <div id="redistributeModal" class="modal">
        <div class="bg-white rounded-lg shadow-xl p-6 max-w-md w-full mx-4">
            <h3 class="text-xl font-bold mb-4">Redistribute Shifts</h3>
            <div class="mb-4"><label class="block text-sm font-semibold mb-2">Start:</label><input type="date" id="redistributeStart" class="w-full p-2 border rounded-lg"></div>
            <div class="mb-6"><label class="block text-sm font-semibold mb-2">End:</label><input type="date" id="redistributeEnd" class="w-full p-2 border rounded-lg"></div>
            <div class="flex gap-3">
                <button onclick="redistributeShifts()" class="flex-1 bg-green-500 text-white px-4 py-2 rounded-lg hover:bg-green-600">Redistribute</button>
                <button onclick="closeRedistributeModal()" class="flex-1 bg-gray-300 px-4 py-2 rounded-lg hover:bg-gray-400">Cancel</button>
            </div>
        </div>
    </div>

    <script>
const DEFAULT_ENGINEERS=[{name:"Alexandra Hock",email:"alexandra.hock@ringcentral.com",schedule:{sun:"OFF",mon:"05:00-14:00",tue:"05:00-14:00",wed:"05:00-14:00",thu:"05:00-14:00",fri:"05:00-14:00",sat:"OFF"},shift:"early"},{name:"Marina Stambaugh",email:"marina.stambaugh@ringcentral.com",schedule:{sun:"OFF",mon:"07:00-16:00",tue:"07:00-16:00",wed:"07:00-16:00",thu:"07:00-16:00",fri:"07:00-16:00",sat:"OFF"},shift:"early"},{name:"Rochelle Gobis",email:"rochelle.gobis@ringcentral.com",schedule:{sun:"OFF",mon:"08:00-15:30",tue:"08:00-15:30",wed:"08:00-15:30",thu:"08:00-15:30",fri:"08:00-15:30",sat:"OFF"},shift:"day"},{name:"Sarah Heriford",email:"sarah.heriford@ringcentral.com",schedule:{sun:"OFF",mon:"08:00-16:30",tue:"08:00-16:30",wed:"08:00-16:30",thu:"08:00-16:30",fri:"08:00-16:30",sat:"OFF"},shift:"day"},{name:"Karla Talamantes",email:"karla.talamantes@ringcentral.com",schedule:{sun:"OFF",mon:"09:00-18:00",tue:"09:00-18:00",wed:"09:00-18:00",thu:"09:00-18:00",fri:"09:00-18:00",sat:"OFF"},shift:"day"},{name:"Jeremy Rodriguez",email:"jeremyr@ringcentral.com",schedule:{sun:"OFF",mon:"08:00-16:30",tue:"08:00-16:30",wed:"08:00-16:30",thu:"08:00-16:30",fri:"08:00-16:30",sat:"OFF"},shift:"day"},{name:"Jenny Deasy",email:"jenny.deasy@ringcentral.com",schedule:{sun:"OFF",mon:"07:00-15:30",tue:"07:00-15:30",wed:"07:00-15:30",thu:"07:00-15:30",fri:"07:00-15:30",sat:"OFF"},shift:"early"},{name:"Bo Lemecha",email:"Bo.Lemecha@ringcentral.com",schedule:{sun:"OFF",mon:"06:00-14:30",tue:"06:00-14:30",wed:"06:00-14:30",thu:"06:00-14:30",fri:"06:00-14:30",sat:"OFF"},shift:"early"},{name:"Edwin Reveley",email:"edwin.reveley@ringcentral.com",schedule:{sun:"OFF",mon:"09:30-18:00",tue:"09:30-18:00",wed:"09:30-18:00",thu:"09:30-18:00",fri:"09:30-18:00",sat:"OFF"},shift:"day"},{name:"Edward Salvador",email:"edward.salvador@ringcentral.com",schedule:{sun:"08:00-15:30",mon:"08:00-15:30",tue:"08:00-15:30",wed:"08:00-15:30",thu:"08:00-15:30",fri:"OFF",sat:"OFF"},shift:"day"},{name:"John Glenn Bayron",email:"john.bayron@ringcentral.com",schedule:{sun:"OFF",mon:"08:00-15:30",tue:"08:00-15:30",wed:"08:00-15:30",thu:"08:00-15:30",fri:"08:00-15:30",sat:"OFF"},shift:"day"},{name:"Robert Carter",email:"robert.carter@ringcentral.com",schedule:{sun:"OFF",mon:"09:00-17:00",tue:"09:00-17:00",wed:"09:00-17:00",thu:"09:00-17:00",fri:"09:00-17:00",sat:"OFF"},shift:"day"},{name:"Dan Baker",email:"dan.baker1@ringcentral.com",schedule:{sun:"OFF",mon:"07:00-15:00",tue:"07:00-15:00",wed:"07:00-15:00",thu:"07:00-15:00",fri:"07:00-15:00",sat:"OFF"},shift:"early"},{name:"John Tran",email:"john.tran@ringcentral.com",schedule:{sun:"OFF",mon:"10:00-18:00",tue:"10:00-18:00",wed:"10:00-18:00",thu:"10:00-18:00",fri:"10:00-18:00",sat:"OFF"},shift:"day"},{name:"Jared Cooper",email:"jared.cooper@ringcentral.com",schedule:{sun:"OFF",mon:"09:00-18:00",tue:"09:00-18:00",wed:"09:00-18:00",thu:"09:00-18:00",fri:"09:00-18:00",sat:"OFF"},shift:"day"},{name:"Lara Mae Dela Cruz",email:"lara.delacruz@ringcentral.com",schedule:{sun:"OFF",mon:"15:00-00:00",tue:"15:00-00:00",wed:"15:00-00:00",thu:"15:00-00:00",fri:"15:00-00:00",sat:"OFF"},shift:"evening"},{name:"Love Lyn Cano",email:"love.cano@ringcentral.com",schedule:{sun:"15:00-00:00",mon:"15:00-00:00",tue:"15:00-00:00",wed:"15:00-00:00",thu:"OFF",fri:"OFF",sat:"15:00-00:00"},shift:"evening"},{name:"James Belleza",email:"james.belleza@ringcentral.com",schedule:{sun:"15:00-00:00",mon:"15:00-00:00",tue:"15:00-00:00",wed:"15:00-00:00",thu:"15:00-00:00",fri:"OFF",sat:"OFF"},shift:"evening"},{name:"Rushikesh Sawant",email:"rushikesh.sawant@ringcentral.com",schedule:{sun:"22:30-07:30",mon:"22:30-07:30",tue:"22:30-07:30",wed:"22:30-07:30",thu:"22:30-07:30",fri:"OFF",sat:"OFF"},shift:"night"},{name:"Santosh Sahoo",email:"santosh.sahoo@ringcentral.com",schedule:{sun:"22:30-07:30",mon:"22:30-07:30",tue:"22:30-07:30",wed:"22:30-07:30",thu:"22:30-07:30",fri:"OFF",sat:"OFF"},shift:"night"},{name:"Srikanth Reddy",email:"srikanth.v@ringcentral.com",schedule:{sun:"22:30-07:30",mon:"22:30-07:30",tue:"22:30-07:30",wed:"22:30-07:30",thu:"22:30-07:30",fri:"OFF",sat:"OFF"},shift:"night"},{name:"Jobon Chinel",email:"jobon.chinel@ringcentral.com",schedule:{sun:"01:00-10:00",mon:"01:00-10:00",tue:"01:00-10:00",wed:"01:00-10:00",thu:"01:00-10:00",fri:"OFF",sat:"OFF"},shift:"night"},{name:"Ryan Hawkins",email:"ryan.hawkins@ringcentral.com",schedule:{sun:"01:00-07:00",mon:"01:00-07:00",tue:"01:00-07:00",wed:"01:00-07:00",thu:"01:00-07:00",fri:"OFF",sat:"OFF"},shift:"night"},{name:"Joseph Bendecio",email:"joseph.bendecio@ringcentral.com",schedule:{sun:"OFF",mon:"OFF",tue:"01:00-10:00",wed:"01:00-10:00",thu:"01:00-10:00",fri:"01:00-10:00",sat:"01:00-10:00"},shift:"night"},{name:"Pearce Hamblin",email:"pearce.hamblin@ringcentral.com",schedule:{sun:"01:00-07:00",mon:"01:00-07:00",tue:"01:00-07:00",wed:"01:00-07:00",thu:"01:00-07:00",fri:"OFF",sat:"OFF"},shift:"night"},{name:"Amine Dahel",email:"amine.dahel@ringcentral.com",schedule:{sun:"00:00-06:00",mon:"00:00-06:00",tue:"00:00-06:00",wed:"00:00-06:00",thu:"00:00-06:00",fri:"OFF",sat:"OFF"},shift:"night"},{name:"Andrew Neill",email:"andrew.neill@ringcentral.com",schedule:{sun:"03:00-09:00",mon:"03:00-09:00",tue:"03:00-09:00",wed:"03:00-09:00",thu:"03:00-09:00",fri:"OFF",sat:"OFF"},shift:"night"},{name:"Andy Connolly",email:"andy.connolly@ringcentral.com",schedule:{sun:"03:00-09:00",mon:"03:00-09:00",tue:"03:00-09:00",wed:"03:00-09:00",thu:"03:00-09:00",fri:"OFF",sat:"OFF"},shift:"night"},{name:"Colin Finn",email:"colin.finn@ringcentral.com",schedule:{sun:"02:00-08:00",mon:"02:00-08:00",tue:"02:00-08:00",wed:"02:00-08:00",thu:"02:00-08:00",fri:"OFF",sat:"OFF"},shift:"night"},{name:"Deepthi Chandran",email:"deepthi.chandran@ringcentral.com",schedule:{sun:"00:00-06:00",mon:"00:00-06:00",tue:"00:00-06:00",wed:"00:00-06:00",thu:"00:00-06:00",fri:"OFF",sat:"OFF"},shift:"night"},{name:"Derek Walker",email:"derek.walker@ringcentral.com",schedule:{sun:"00:00-06:00",mon:"00:00-06:00",tue:"00:00-06:00",wed:"00:00-06:00",thu:"00:00-06:00",fri:"OFF",sat:"OFF"},shift:"night"},{name:"Hugo Nickal-Thibeaud",email:"hugo.thibeaud@ringcentral.com",schedule:{sun:"02:00-08:00",mon:"02:00-08:00",tue:"02:00-08:00",wed:"02:00-08:00",thu:"02:00-08:00",fri:"OFF",sat:"OFF"},shift:"night"},{name:"Baranee Selvendran",email:"baranee.selvendran@ringcentral.com",schedule:{sun:"02:00-10:00",mon:"02:00-10:00",tue:"02:00-10:00",wed:"02:00-10:00",thu:"02:00-10:00",fri:"OFF",sat:"OFF"},shift:"night"},{name:"Eryll Azucena",email:"eryll.azucena@ringcentral.com",schedule:{sun:"OFF",mon:"08:00-15:30",tue:"08:00-15:30",wed:"08:00-15:30",thu:"08:00-15:30",fri:"08:00-15:30",sat:"08:00-15:30"},shift:"day"},{name:"Mare Snyder",email:"mare.snyder@ringcentral.com",schedule:{sun:"OFF",mon:"09:00-18:00",tue:"09:00-18:00",wed:"09:00-18:00",thu:"09:00-18:00",fri:"09:00-18:00",sat:"OFF"},shift:"day"},{name:"Nate Malone",email:"nate.malone@ringcentral.com",schedule:{sun:"OFF",mon:"07:00-16:00",tue:"07:00-16:00",wed:"07:00-16:00",thu:"07:00-16:00",fri:"07:00-16:00",sat:"OFF"},shift:"early"},{name:"Peter Czarnecki",email:"peter.czarnecki@ringcentral.com",schedule:{sun:"OFF",mon:"06:00-14:30",tue:"06:00-14:30",wed:"06:00-14:30",thu:"06:00-14:30",fri:"06:00-14:30",sat:"OFF"},shift:"early"},{name:"Colby Jestes",email:"colby.jestes@ringcentral.com",schedule:{sun:"OFF",mon:"08:00-16:30",tue:"08:00-16:30",wed:"08:00-16:30",thu:"08:00-16:30",fri:"08:00-16:30",sat:"OFF"},shift:"day"},{name:"Mark Peirce",email:"mark.peirce@ringcentral.com",schedule:{sun:"OFF",mon:"09:00-18:00",tue:"09:00-18:00",wed:"09:00-18:00",thu:"09:00-18:00",fri:"09:00-18:00",sat:"OFF"},shift:"day"},{name:"Roscoe Bryant",email:"roscoe.bryant@ringcentral.com",schedule:{sun:"OFF",mon:"08:30-17:00",tue:"08:30-17:00",wed:"08:30-17:00",thu:"08:30-17:00",fri:"08:30-17:00",sat:"OFF"},shift:"day"},{name:"Cindy Hubert",email:"cindy.hubert@ringcentral.com",schedule:{sun:"OFF",mon:"07:00-16:00",tue:"07:00-16:00",wed:"07:00-16:00",thu:"07:00-16:00",fri:"07:00-16:00",sat:"OFF"},shift:"early"},{name:"Abby Bearden",email:"abby.bearden@ringcentral.com",schedule:{sun:"OFF",mon:"06:00-15:00",tue:"06:00-15:00",wed:"06:00-15:00",thu:"06:00-15:00",fri:"06:00-15:00",sat:"OFF"},shift:"early"},{name:"Tim Arnott",email:"tim.arnott@ringcentral.com",schedule:{sun:"OFF",mon:"06:00-15:00",tue:"06:00-15:00",wed:"06:00-15:00",thu:"06:00-15:00",fri:"06:00-15:00",sat:"OFF"},shift:"early"},{name:"Tomislav Vranjes",email:"tomislav.vranjes@ringcentral.com",schedule:{sun:"OFF",mon:"09:30-18:00",tue:"09:30-18:00",wed:"09:30-18:00",thu:"09:30-18:00",fri:"09:30-18:00",sat:"OFF"},shift:"day"}];
let config={username:"",repo:"",token:"",branch:"main"},fileSha="",calendarData={rotation:{},engineers:[...DEFAULT_ENGINEERS]},currentMonth=0,selectedDate=null,editingDate=null,editingShift=null,editingEngineerIndex=null;function showLoading(){document.getElementById("loadingBar").style.display="block"}function hideLoading(){document.getElementById("loadingBar").style.display="none"}function showPage(e){document.querySelectorAll(".page").forEach(e=>e.classList.remove("active")),document.querySelectorAll("[id^=nav]").forEach(e=>{e.classList.remove("bg-red-700"),e.classList.add("hover:bg-red-700")}),"calendar"===e?(document.getElementById("calendarPage").classList.add("active"),document.getElementById("navCalendar").classList.add("bg-red-700")):"engineers"===e?(document.getElementById("engineersPage").classList.add("active"),document.getElementById("navEngineers").classList.add("bg-red-700"),renderEngineersTable()):"settings"===e&&(document.getElementById("settingsPage").classList.add("active"),document.getElementById("navSettings").classList.add("bg-red-700"),loadSettings())}function loadSettings(){const e=localStorage.getItem("adminConfig");e&&(config=JSON.parse(e),document.getElementById("githubUsername").value=config.username,document.getElementById("githubRepo").value=config.repo,document.getElementById("githubToken").value=config.token,document.getElementById("githubBranch").value=config.branch)}async function saveSettings(){config={username:document.getElementById("githubUsername").value.trim(),repo:document.getElementById("githubRepo").value.trim(),token:document.getElementById("githubToken").value.trim(),branch:document.getElementById("githubBranch").value.trim()||"main"};if(!config.username||!config.repo||!config.token)return void showStatus("All fields required","error");localStorage.setItem("adminConfig",JSON.stringify(config)),showStatus("Connecting...","info");try{await loadData(),showStatus("‚úÖ Connected!","success"),setTimeout(()=>showPage("calendar"),1500)}catch(e){showStatus("‚ö†Ô∏è Saved but couldn't load data","warning")}}function showStatus(e,t){const a=document.getElementById("settingsStatus"),n={success:"bg-green-50 text-green-800 border-green-200",error:"bg-red-50 text-red-800 border-red-200",warning:"bg-yellow-50 text-yellow-800 border-yellow-200",info:"bg-blue-50 text-blue-800 border-blue-200"};a.className=`p-4 rounded-lg border ${n[t]}`,a.textContent=e}async function loadData(){if(!config.token)return;showLoading();try{const e=await fetch(`https://api.github.com/repos/${config.username}/${config.repo}/contents/noc-calendar-data.json?ref=${config.branch}`,{headers:{Authorization:`token ${config.token}`,Accept:"application/vnd.github.v3+json"}});if(e.ok){const t=await e.json();fileSha=t.sha,calendarData=JSON.parse(atob(t.content))}else calendarData={rotation:{},engineers:[...DEFAULT_ENGINEERS]},generateRotation(),await saveData();renderCalendar(),renderEngineersTable()}catch(e){console.error(e)}finally{hideLoading()}}async function saveData(){if(!config.token)return;showLoading();try{const e=btoa(unescape(encodeURIComponent(JSON.stringify(calendarData,null,2)))),t={message:"Update NOC calendar",content:e,branch:config.branch};fileSha&&(t.sha=fileSha);const a=await fetch(`https://api.github.com/repos/${config.username}/${config.repo}/contents/noc-calendar-data.json`,{method:"PUT",headers:{Authorization:`token ${config.token}`,Accept:"application/vnd.github.v3+json","Content-Type":"application/json"},body:JSON.stringify(t)});if(a.ok){const e=await a.json();fileSha=e.content.sha}}catch(e){console.error(e),alert("Save error")}finally{hideLoading()}}function renderEngineersTable(){const e=document.getElementById("engineersTable");e.innerHTML="",calendarData.engineers.forEach((t,a)=>{const n=document.createElement("tr");n.innerHTML=`<td class="border p-2 text-sm">${t.name}</td><td class="border p-2 text-sm">${t.email}</td><td class="border p-2 text-sm">${t.shift}</td><td class="border p-2 text-xs text-center">${t.schedule.sun}</td><td class="border p-2 text-xs text-center">${t.schedule.mon}</td><td class="border p-2 text-xs text-center">${t.schedule.tue}</td><td class="border p-2 text-xs text-center">${t.schedule.wed}</td><td class="border p-2 text-xs text-center">${t.schedule.thu}</td><td class="border p-2 text-xs text-center">${t.schedule.fri}</td><td class="border p-2 text-xs text-center">${t.schedule.sat}</td><td class="border p-2 text-center"><button onclick="editEngineer(${a})" class="px-2 py-1 text-xs bg-blue-500 text-white rounded hover:bg-blue-600 mr-1">Edit</button><button onclick="deleteEngineer(${a})" class="px-2 py-1 text-xs bg-red-500 text-white rounded hover:bg-red-600">Del</button></td>`,e.appendChild(n)})}function addEngineer(){editingEngineerIndex=-1,document.getElementById("editEngName").value="",document.getElementById("editEngEmail").value="",document.getElementById("editEngShift").value="day",document.getElementById("editEngSun").value="OFF",document.getElementById("editEngMon").value="08:00-17:00",document.getElementById("editEngTue").value="08:00-17:00",document.getElementById("editEngWed").value="08:00-17:00",document.getElementById("editEngThu").value="08:00-17:00",document.getElementById("editEngFri").value="08:00-17:00",document.getElementById("editEngSat").value="OFF",document.getElementById("editEngineerModal").classList.add("show")}function editEngineer(e){editingEngineerIndex=e;const t=calendarData.engineers[e];document.getElementById("editEngName").value=t.name,document.getElementById("editEngEmail").value=t.email,document.getElementById("editEngShift").value=t.shift,document.getElementById("editEngSun").value=t.schedule.sun,document.getElementById("editEngMon").value=t.schedule.mon,document.getElementById("editEngTue").value=t.schedule.tue,document.getElementById("editEngWed").value=t.schedule.wed,document.getElementById("editEngThu").value=t.schedule.thu,document.getElementById("editEngFri").value=t.schedule.fri,document.getElementById("editEngSat").value=t.schedule.sat,document.getElementById("editEngineerModal").classList.add("show")}async function saveEngineer(){const e={name:document.getElementById("editEngName").value.trim(),email:document.getElementById("editEngEmail").value.trim(),shift:document.getElementById("editEngShift").value,schedule:{sun:document.getElementById("editEngSun").value.trim(),mon:document.getElementById("editEngMon").value.trim(),tue:document.getElementById("editEngTue").value.trim(),wed:document.getElementById("editEngWed").value.trim(),thu:document.getElementById("editEngThu").value.trim(),fri:document.getElementById("editEngFri").value.trim(),sat:document.getElementById("editEngSat").value.trim()}};e.name&&e.email?(-1===editingEngineerIndex?calendarData.engineers.push(e):calendarData.engineers[editingEngineerIndex]=e,await saveData(),closeEngineerModal(),renderEngineersTable()):alert("Name and email required")}async function deleteEngineer(e){confirm(`Delete ${calendarData.engineers[e].name}?`)&&(calendarData.engineers.splice(e,1),await saveData(),renderEngineersTable())}function closeEngineerModal(){document.getElementById("editEngineerModal").classList.remove("show"),editingEngineerIndex=null}function showRedistributeModal(){const e=new Date;document.getElementById("redistributeStart").value=e.toISOString().split("T")[0];const t=new Date(e);t.setDate(t.getDate()+30),document.getElementById("redistributeEnd").value=t.toISOString().split("T")[0],document.getElementById("redistributeModal").classList.add("show")}function closeRedistributeModal(){document.getElementById("redistributeModal").classList.remove("show")}async function redistributeShifts(){const e=document.getElementById("redistributeStart").value,t=document.getElementById("redistributeEnd").value;if(!e||!t)return void alert("Select both dates");const a=new Date(e),n=new Date(t);if(a>n)return void alert("Start before end");if(confirm("Redistribute?")){const e={early:calendarData.engineers.filter(e=>"early"===e.shift),day:calendarData.engineers.filter(e=>"day"===e.shift),evening:calendarData.engineers.filter(e=>"evening"===e.shift),night:calendarData.engineers.filter(e=>"night"===e.shift)},t={early:0,day:0,evening:0,night:0};let r=new Date(a);for(;r<=n;){const a=r.getDay(),n=r.toISOString().split("T")[0];calendarData.rotation[n]||(calendarData.rotation[n]={}),Object.keys(e).forEach(s=>{const i=e[s].filter(e=>isWorking(e,a));if(i.length>0){const e=i[t[s]%i.length];calendarData.rotation[n][s]=e,t[s]++}}),r.setDate(r.getDate()+1)}await saveData(),closeRedistributeModal(),renderCalendar(),alert("Done!")}}function isWorking(e,t){return"OFF"!==e.schedule[["sun","mon","tue","wed","thu","fri","sat"][t]]}function generateRotation(){const e=new Date(2025,10,18),t={early:calendarData.engineers.filter(e=>"early"===e.shift),day:calendarData.engineers.filter(e=>"day"===e.shift),evening:calendarData.engineers.filter(e=>"evening"===e.shift),night:calendarData.engineers.filter(e=>"night"===e.shift)},a={early:0,day:0,evening:0,night:0};for(let n=0;n<75;n++){const r=new Date(e);r.setDate(r.getDate()+n);const s=r.getDay(),i=r.toISOString().split("T")[0];calendarData.rotation[i]={},Object.keys(t).forEach(e=>{const n=t[e].filter(e=>isWorking(e,s));if(n.length>0){const t=n[a[e]%n.length];calendarData.rotation[i][e]=t,a[e]++}})}}async function resetRotation(){confirm("Reset?")&&(generateRotation(),await saveData(),renderCalendar(),selectedDate&&showDateDetails(selectedDate))}function getCalendarData(){const e=new Date(2025,10,1);e.setMonth(e.getMonth()+currentMonth);const t=e.getFullYear(),a=e.getMonth();return{monthName:["January","February","March","April","May","June","July","August","September","October","November","December"][a],year:t,daysInMonth:new Date(t,a+1,0).getDate(),startingDayOfWeek:new Date(t,a,1).getDay(),month:a}}function renderCalendar(){const e=getCalendarData(),t=document.getElementById("calendarGrid");t.innerHTML="",t.className="col-span-7 grid grid-cols-7";for(let a=0;a<e.startingDayOfWeek;a++){const e=document.createElement("div");e.className="p-2 border border-gray-100",t.appendChild(e)}for(let a=1;a<=e.daysInMonth;a++){const n=new Date(e.year,e.month,a),r=n.toISOString().split("T")[0],s=calendarData.rotation[r]||{},i=new Date;i.setHours(0,0,0,0);const o=n.getTime()===i.getTime(),l=document.createElement("div");l.className=`calendar-cell p-2 border border-gray-200 cursor-pointer transition-colors ${o?"bg-blue-100 border-blue-400":""} ${selectedDate===r?"selected-cell":""}`,l.onclick=()=>selectDate(r);let d=`<div class="font-semibold text-sm mb-1 ${o?"text-blue-700":"text-gray-700"}">${a}</div><div class="text-xs space-y-1">`;s.night&&(d+=`<div class="bg-indigo-100 text-indigo-800 px-1 py-0.5 rounded truncate">üåô ${s.night.name.split(" ")[0]}</div>`),s.early&&(d+=`<div class="bg-amber-100 text-amber-800 px-1 py-0.5 rounded truncate">üåÖ ${s.early.name.split(" ")[0]}</div>`),s.day&&(d+=`<div class="bg-green-100 text-green-800 px-1 py-0.5 rounded truncate">‚òÄÔ∏è ${s.day.name.split(" ")[0]}</div>`),s.evening&&(d+=`<div class="bg-purple-100 text-purple-800 px-1 py-0.5 rounded truncate">üåÜ ${s.evening.name.split(" ")[0]}</div>`),d+="</div>",l.innerHTML=d,t.appendChild(l)}document.getElementById("monthDisplay").textContent=`${e.monthName} ${e.year}`,updateButtons()}function selectDate(e){selectedDate=e,renderCalendar(),showDateDetails(e)}function showDateDetails(e){const t=calendarData.rotation[e]||{},a=new Date(e).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),n=new Date(e).getDay(),r=["sun","mon","tue","wed","thu","fri","sat"],s=document.getElementById("selectedDetails");s.className="mt-6 bg-white border-2 border-blue-200 rounded-lg p-4 shadow-lg";let i=`<h3 class="text-lg font-bold mb-3">${a}</h3><div class="space-y-3">`;t.night&&(i+=`<div class="border-l-4 border-indigo-500 pl-3 py-2 bg-indigo-50 rounded"><div class="flex justify-between items-start"><div class="flex-1"><div class="font-semibold text-indigo-900">üåô Night</div><div class="text-sm text-indigo-800">${t.night.name}</div><div class="text-xs text-indigo-600">${t.night.email}</div><div class="text-xs text-indigo-700 mt-1">${t.night.schedule[r[n]]}</div></div><button onclick="editAssignment('${e}','night')" class="ml-2 px-2 py-1 text-xs bg-indigo-500 text-white rounded hover:bg-indigo-600">Edit</button></div></div>`),t.early&&(i+=`<div class="border-l-4 border-amber-500 pl-3 py-2 bg-amber-50 rounded"><div class="flex justify-between items-start"><div class="flex-1"><div class="font-semibold text-amber-900">üåÖ Early</div><div class="text-sm text-amber-800">${t.early.name}</div><div class="text-xs text-amber-600">${t.early.email}</div><div class="text-xs text-amber-700 mt-1">${t.early.schedule[r[n]]}</div></div><button onclick="editAssignment('${e}','early')" class="ml-2 px-2 py-1 text-xs bg-amber-500 text-white rounded hover:bg-amber-600">Edit</button></div></div>`),t.day&&(i+=`<div class="border-l-4 border-green-500 pl-3 py-2 bg-green-50 rounded"><div class="flex justify-between items-start"><div class="flex-1"><div class="font-semibold text-green-900">‚òÄÔ∏è Day</div><div class="text-sm text-green-800">${t.day.name}</div><div class="text-xs text-green-600">${t.day.email}</div><div class="text-xs text-green-700 mt-1">${t.day.schedule[r[n]]}</div></div><button onclick="editAssignment('${e}','day')" class="ml-2 px-2 py-1 text-xs bg-green-500 text-white rounded hover:bg-green-600">Edit</button></div></div>`),t.evening&&(i+=`<div class="border-l-4 border-purple-500 pl-3 py-2 bg-purple-50 rounded"><div class="flex justify-between items-start"><div class="flex-1"><div class="font-semibold text-purple-900">üåÜ Evening</div><div class="text-sm text-purple-800">${t.evening.name}</div><div class="text-xs text-purple-600">${t.evening.email}</div><div class="text-xs text-purple-700 mt-1">${t.evening.schedule[r[n]]}</div></div><button onclick="editAssignment('${e}','evening')" class="ml-2 px-2 py-1 text-xs bg-purple-500 text-white rounded hover:bg-purple-600">Edit</button></div></div>`),i+="</div>",s.innerHTML=i}function editAssignment(e,t){editingDate=e,editingShift=t;const a=new Date(e).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),n=new Date(e).getDay(),r={night:"üåô Night",early:"üåÖ Early",day:"‚òÄÔ∏è Day",evening:"üåÜ Evening"};document.getElementById("modalDate").textContent=a,document.getElementById("modalShift").textContent=r[t];const s=calendarData.engineers.filter(e=>e.shift===t&&isWorking(e,n)),i=document.getElementById("engineerSelect");i.innerHTML="",s.forEach(e=>{const t=document.createElement("option");t.value=e.email,t.textContent=`${e.name} (${e.email})`,i.appendChild(t)}),document.getElementById("editModal").classList.add("show")}function closeModal(){document.getElementById("editModal").classList.remove("show"),editingDate=null,editingShift=null}async function saveEdit(){const e=document.getElementById("engineerSelect").value,t=calendarData.engineers.find(t=>t.email===e);t&&editingDate&&editingShift&&(calendarData.rotation[editingDate][editingShift]=t,await saveData(),closeModal(),renderCalendar(),showDateDetails(editingDate))}function changeMonth(e){const t=currentMonth+e;t>=0&&t<=2&&(currentMonth=t,selectedDate=null,document.getElementById("selectedDetails").className="mt-6 hidden",renderCalendar())}function updateButtons(){document.getElementById("prevBtn").disabled=0===currentMonth,document.getElementById("nextBtn").disabled=2===currentMonth,document.getElementById("prevBtn").className=0===currentMonth?"p-2 rounded-lg bg-gray-300 text-white cursor-not-allowed":"p-2 rounded-lg bg-blue-500 text-white hover:bg-blue-600",document.getElementById("nextBtn").className=2===currentMonth?"p-2 rounded-lg bg-gray-300 text-white cursor-not-allowed":"p-2 rounded-lg bg-blue-500 text-white hover:bg-blue-600"}loadSettings();
    </script>
</body>
</html>
